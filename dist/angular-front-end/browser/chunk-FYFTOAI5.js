import{a as P}from"./chunk-5QGIM47I.js";import{a as E}from"./chunk-N5VNVSCG.js";import{a as D,c as I,f as b}from"./chunk-WU2B4YHF.js";import{a as T}from"./chunk-AV6STA5B.js";import"./chunk-ZFVO5NLJ.js";import{$ as g,Ab as s,D as _,Ib as y,Ja as c,Ka as m,S as h,Sa as O,X as w,_a as u,cb as l,fc as L,j as x,kb as o,lb as a,m as k,mb as p,nc as S,sb as v}from"./chunk-Q57VKX57.js";var M=(()=>{let e=class e{constructor(){this.permission=this.isSupported()?"default":"denied"}isSupported(){return"Notification"in window}requestPermission(){this.isSupported()&&Notification.requestPermission(t=>{this.permission=t})}create(t,i){return new x(r=>{if(!this.isSupported())console.log("Notifications are not available in this environment"),r.complete();else if(this.permission!=="granted")console.log("The user hasn't granted you permission to send push notifications"),r.complete();else{let d=new Notification(t,i);d.onshow=f=>{r.next({notification:d,event:f})},d.onclick=f=>{r.next({notification:d,event:f})},d.onerror=f=>{r.error({notification:d,event:f})},d.onclose=()=>{r.complete()},i&&i.sound&&new Audio(i.sound).play()}})}generateNotification(t){t.forEach(i=>{let r={body:i.body,icon:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRh8VGfy1GKL5vwnciBKTzhkWZ5mzVKDH9wGQ&s",sound:"../../assets/sounds/pop-up_sound.mp3",tag:"completed",data:"This is Push Notification",renotify:!1,silent:!1,noscreen:!1,sticky:!0,dir:"rtl",lang:"en-US",vibrate:[200,100,200]};this.create(i.title,r).subscribe()})}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=h({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function F(n,e){n&1&&(o(0,"div",18)(1,"ul",19)(2,"li",7)(3,"a",20),s(4,"Create Ride"),a()(),o(5,"li",7)(6,"a",20),s(7,"Confirmed Rides"),a()(),o(8,"li",7)(9,"a",20),s(10,"Ride History"),a()()()()),n&2&&(c(2),l("routerLink","ride/create-ride"),c(3),l("routerLink","ride/confirmed-rides"),c(3),l("routerLink","ride/ride-history"))}function q(n,e){n&1&&(o(0,"div",18)(1,"ul",19)(2,"li",7)(3,"a",20),s(4,"List"),a()(),o(5,"li",7)(6,"a",20),s(7,"Running Requests"),a()()()()),n&2&&(c(2),l("routerLink","drivers/list"),c(3),l("routerLink","drivers/running-request"))}function U(n,e){n&1&&(o(0,"div",18)(1,"ul",19)(2,"li",21)(3,"a",20),s(4,"Country"),a()(),o(5,"li",21)(6,"a",20),s(7,"City"),a()(),o(8,"li",21)(9,"a",20),s(10,"Vehicle Type"),a()(),o(11,"li",21)(12,"a",20),s(13,"Vehicle Pricing"),a()()()()),n&2&&(c(2),l("routerLink","pricing/country"),c(3),l("routerLink","pricing/city"),c(3),l("routerLink","pricing/vehicle-type"),c(3),l("routerLink","pricing/vehicle-pricing"))}function Z(n,e){n&1&&(o(0,"div"),p(1,"app-loader"),a())}var R=(()=>{let e=class e{constructor(t,i,r,d){this.authservice=t,this.loaderService=i,this.rideSocketService=r,this.pushNotificationService=d,this.isRidesDropdownOpen=!1,this.isDriverDropdownOpen=!1,this.isPricingDropdownOpen=!1,this.isLoading=!1}ngOnInit(){this.loaderService.isLoading$.subscribe(i=>this.isLoading=i),this.pushNotificationService.requestPermission();let t=0;this.rideSocketService.onCronStop().subscribe(i=>{i.message=="Accepted"?t>0&&(t--,this.showNotification("Accepted Ride","Your ride has been accepted")):(t++,this.showNotification("Rejected Ride","Your ride has not been accepted"));let r=document.getElementById("notification-handler");r.innerHTML=`<i class="fa fa-bell" aria-hidden="true"></i>Notifications (${t})`})}toggleDropdown(t){t==="rides"?this.isRidesDropdownOpen=!this.isRidesDropdownOpen:t==="driver"?this.isDriverDropdownOpen=!this.isDriverDropdownOpen:t==="pricing"&&(this.isPricingDropdownOpen=!this.isPricingDropdownOpen)}onClickLogOut(){this.authservice.logOutManually()}showNotification(t,i){let r=[{title:t,body:i}];this.pushNotificationService.generateNotification(r)}};e.\u0275fac=function(i){return new(i||e)(m(b),m(P),m(T),m(M))},e.\u0275cmp=g({type:e,selectors:[["app-sidebar"]],standalone:!0,features:[y],decls:36,vars:6,consts:[[1,"sidebar"],[1,"px-5","text-light"],[1,"px-2","nav","flex-column"],[1,"nav-item",3,"click"],[1,"nav-link","dropdown-toggle","fs-5"],[1,"fas","fa-car"],["class","ps-4",4,"ngIf"],[1,"nav-item",3,"routerLink"],[1,"nav-link","fs-5"],[1,"fas","fa-users"],[1,"fas","fa-user-tie"],[1,"fas","fa-dollar-sign"],[1,"fas","fa-cog"],[1,"fas","fa-sign-out-alt"],[1,"nav-item"],["id","notification-handler",1,"nav-link","fs-5"],["aria-hidden","true",1,"fa","fa-bell"],[4,"ngIf"],[1,"ps-4"],[1,"nav","flex-column","pl-4"],[1,"nav-link"],["routerLinkActive","active",1,"nav-item",3,"routerLink"]],template:function(i,r){i&1&&(o(0,"div",0)(1,"h4",1),s(2,"Admin Panel"),a(),o(3,"ul",2)(4,"li",3),v("click",function(){return r.toggleDropdown("rides")}),o(5,"a",4),p(6,"i",5),s(7," Rides"),a(),u(8,F,11,3,"div",6),a(),o(9,"li",7)(10,"a",8),p(11,"i",9),s(12,"Users"),a()(),o(13,"li",3),v("click",function(){return r.toggleDropdown("driver")}),o(14,"a",4),p(15,"i",10),s(16," Drivers"),a(),u(17,q,8,2,"div",6),a(),o(18,"li",3),v("click",function(){return r.toggleDropdown("pricing")}),o(19,"a",4),p(20,"i",11),s(21," Pricing"),a(),u(22,U,14,4,"div",6),a(),o(23,"li",7)(24,"a",8),p(25,"i",12),s(26," Settings"),a()(),o(27,"li",3),v("click",function(){return r.onClickLogOut()}),o(28,"a",8),p(29,"i",13),s(30," Logout"),a()(),o(31,"li",14)(32,"a",15),p(33,"i",16),s(34," Notifications (0)"),a()()()(),u(35,Z,2,0,"div",17)),i&2&&(c(8),l("ngIf",r.isRidesDropdownOpen),c(),l("routerLink","users"),c(8),l("ngIf",r.isDriverDropdownOpen),c(5),l("ngIf",r.isPricingDropdownOpen),c(),l("routerLink","settings"),c(12),l("ngIf",r.isLoading))},dependencies:[S,L,I,E],styles:[".sidebar[_ngcontent-%COMP%]{position:relative;top:0;left:0;height:100%;width:250px;background-color:#343a40;padding-top:3rem}.sidebar[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding:10px;text-decoration:none;display:block;color:#fff}.sidebar[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background-color:#495057}.sidebar[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{background-color:#adb5bd}.sidebar-bottom[_ngcontent-%COMP%]{position:absolute;bottom:0;width:100%}.sidebar-bottom[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#fff;padding:10px;text-align:center}"]});let n=e;return n})();var N=(()=>{let e=class e{constructor(t,i){this.ngZone=t,this.authService=i,this.userActivity=new k,this.inactivityTime=3e6,this.userInactive=new k,this.setInactivityTimer(),this.userActivity.pipe(_(this.inactivityTime)).subscribe(()=>this.userInactive.next(void 0)),this.userInactive.subscribe(()=>this.onUserInactive())}setInactivityTimer(){this.ngZone.runOutsideAngular(()=>{["mousemove","mousedown","keypress","touchstart","scroll"].forEach(i=>{document.addEventListener(i,()=>this.userActivity.next(void 0),{passive:!0})})})}onUserInactive(){console.log("User is inactive"),this.ngZone.run(()=>{this.authService.logOutForcefully()})}};e.\u0275fac=function(i){return new(i||e)(w(O),w(b))},e.\u0275prov=h({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var oe=(()=>{let e=class e{constructor(t){this.inactivityService=t}};e.\u0275fac=function(i){return new(i||e)(m(N))},e.\u0275cmp=g({type:e,selectors:[["app-admin-panel"]],standalone:!0,features:[y],decls:3,vars:0,consts:[["id","adminDiv"]],template:function(i,r){i&1&&(o(0,"div",0),p(1,"app-sidebar")(2,"router-outlet"),a())},dependencies:[R,D,S],styles:["#adminDiv[_ngcontent-%COMP%]{background-color:#e5ebef;display:flex;min-height:100dvh;min-width:100dvw}"]});let n=e;return n})();export{oe as AdminPanelComponent};
